# Benchmarks

> Auto-generated by `cargo run --release --bin bench_tools`. Do not edit manually.
> Last updated: 2026-02-15 on `darwin-arm64`

All benchmarks: warm cache (`--warmup 3`), 3 runs, output to pipe. NDJSON uses parallel processing.
Median of 3 runs via [hyperfine](https://github.com/sharkdp/hyperfine).

| Filter | File | **qj** | jq | jaq | gojq |
|--------|------|------|------|------|------|
| `-c '.'` | twitter.json | **1.9ms** | 17.0ms | 6.9ms | 9.5ms |
| `-c '.statuses'` | twitter.json | **4.3ms** | 17.0ms | 6.5ms | 8.8ms |
| `'.statuses|length'` | twitter.json | **2.3ms** | 9.0ms | 5.4ms | 6.6ms |
| `'.statuses[]|.user.name'` | twitter.json | **3.8ms** | 9.4ms | 5.3ms | 6.7ms |
| `'.statuses[]|select(.retweet_count>0)|{user:.user.screen_name,n:.retweet_count}'` | twitter.json | **4.5ms** | 9.5ms | 5.6ms | 7.8ms |
| `'[.statuses[]|.retweet_count|floor]'` | twitter.json | **4.0ms** | 9.6ms | 5.6ms | 7.2ms |
| `'[.statuses[]|.user.screen_name|split("_")|join("-")]'` | twitter.json | **3.3ms** | 8.9ms | 7.0ms | 7.6ms |
| `'[.statuses[]|.user.screen_name]|unique|length'` | twitter.json | **4.1ms** | 8.6ms | 5.4ms | 6.3ms |
| `'[paths(scalars)]|length'` | twitter.json | **6.3ms** | 19.5ms | 17.6ms | 20.0ms |
| `'.statuses[0]|map_values(tojson)'` | twitter.json | **3.7ms** | 10.2ms | 5.9ms | 6.9ms |
| `'reduce .statuses[] as $s (0; . + $s.retweet_count)'` | twitter.json | **3.8ms** | 9.8ms | 5.6ms | 7.1ms |
| `'.statuses[] | . as $s | {name: $s.user.screen_name, rts: $s.retweet_count}'` | twitter.json | **3.6ms** | 9.7ms | 5.5ms | 7.0ms |
| `'[.statuses[].user.screen_name][:5]'` | twitter.json | **3.9ms** | 9.7ms | 5.5ms | 6.8ms |
| `'[.statuses[] | try (1 / .retweet_count)]'` | twitter.json | **3.9ms** | 10.0ms | 5.9ms | 6.7ms |
| `'[.statuses[] | if .retweet_count > 10 then "viral" elif .retweet_count > 0 then "shared" else "original" end]'` | twitter.json | **4.4ms** | 10.3ms | 6.2ms | 6.7ms |
| `-c 'walk(if type == "boolean" then not else . end)'` | twitter.json | **7.7ms** | 39.5ms | 26.2ms | 19.8ms |
| `-c '.statuses[0].retweet_count |= . + 1'` | twitter.json | **4.5ms** | 17.2ms | 7.5ms | 9.2ms |
| `-c '.statuses[] |= (.retweet_count += 1)'` | twitter.json | **5.6ms** | 17.8ms | 6.4ms | 9.7ms |
| `-c '[.statuses[]|.user.screen_name|gsub("_"; "-")]'` | twitter.json | **4.0ms** | 10.1ms | 6.0ms | 7.4ms |
| `-c '[.statuses[]|"@\(.user.screen_name): \(.text[0:30])"]'` | twitter.json | **4.5ms** | 9.8ms | 6.1ms | 7.5ms |
| `-c '[.statuses[]|.user.screen_name|@base64]'` | twitter.json | **3.8ms** | 9.3ms | 6.4ms | 7.4ms |
| `-c 'def hi(rt): if rt > 10 then "viral" elif rt > 0 then "shared" else "none" end; [.statuses[] | hi(.retweet_count)]'` | twitter.json | **3.3ms** | 9.3ms | 5.8ms | 6.7ms |
| `-c '.'` | large_twitter.json | **18.6ms** | 1.24s | 271.4ms | 481.4ms |
| `-c '.statuses'` | large_twitter.json | **203.1ms** | 1.21s | 267.5ms | 465.5ms |
| `'.statuses|length'` | large_twitter.json | **32.6ms** | 412.2ms | 170.7ms | 293.1ms |
| `'.statuses[]|.user.name'` | large_twitter.json | **155.7ms** | 415.8ms | 177.6ms | 310.2ms |
| `'.statuses[]|select(.retweet_count>0)|{user:.user.screen_name,n:.retweet_count}'` | large_twitter.json | **154.8ms** | 428.2ms | 190.9ms | 316.9ms |
| `'[.statuses[]|.retweet_count|floor]'` | large_twitter.json | **151.6ms** | 422.0ms | 174.2ms | 303.3ms |
| `'[.statuses[]|.user.screen_name|split("_")|join("-")]'` | large_twitter.json | **166.0ms** | 444.8ms | 221.3ms | 305.0ms |
| `'[.statuses[]|.user.screen_name]|unique|length'` | large_twitter.json | **159.0ms** | 422.6ms | 180.4ms | 306.0ms |
| `'[paths(scalars)]|length'` | large_twitter.json | **363.3ms** | 1.51s | 1.55s | 1.55s |
| `'.statuses[0]|map_values(tojson)'` | large_twitter.json | **148.6ms** | 409.3ms | 171.3ms | 295.8ms |
| `'reduce .statuses[] as $s (0; . + $s.retweet_count)'` | large_twitter.json | **154.9ms** | 417.3ms | 177.0ms | 301.3ms |
| `'.statuses[] | . as $s | {name: $s.user.screen_name, rts: $s.retweet_count}'` | large_twitter.json | **161.3ms** | 431.3ms | 186.8ms | 313.7ms |
| `'[.statuses[].user.screen_name][:5]'` | large_twitter.json | **151.6ms** | 418.3ms | 194.4ms | 302.6ms |
| `'[.statuses[] | try (1 / .retweet_count)]'` | large_twitter.json | **149.3ms** | 418.1ms | 176.6ms | 301.7ms |
| `'[.statuses[] | if .retweet_count > 10 then "viral" elif .retweet_count > 0 then "shared" else "original" end]'` | large_twitter.json | **154.7ms** | 417.4ms | 176.4ms | 301.8ms |
| `-c 'walk(if type == "boolean" then not else . end)'` | large_twitter.json | **378.8ms** | 3.67s | 2.47s | 1.63s |
| `-c '.statuses[0].retweet_count |= . + 1'` | large_twitter.json | **207.9ms** | 1.36s | 275.7ms | 499.6ms |
| `-c '.statuses[] |= (.retweet_count += 1)'` | large_twitter.json | **222.5ms** | 1.26s | 272.8ms | 485.2ms |
| `-c '[.statuses[]|.user.screen_name|gsub("_"; "-")]'` | large_twitter.json | **179.4ms** | 480.7ms | 223.7ms | 329.3ms |
| `-c '[.statuses[]|"@\(.user.screen_name): \(.text[0:30])"]'` | large_twitter.json | **158.9ms** | 437.5ms | 190.2ms | 314.8ms |
| `-c '[.statuses[]|.user.screen_name|@base64]'` | large_twitter.json | **164.0ms** | 424.1ms | 189.4ms | 307.3ms |
| `-c 'def hi(rt): if rt > 10 then "viral" elif rt > 0 then "shared" else "none" end; [.statuses[] | hi(.retweet_count)]'` | large_twitter.json | **170.6ms** | 427.9ms | 181.1ms | 316.9ms |

### NDJSON (parallel processing)

qj processes NDJSON in parallel across all cores using rayon.

| Filter | File | **qj** | jq | jaq | gojq |
|--------|------|------|------|------|------|
| `'.name'` | 100k.ndjson | **25.2ms** | 135.1ms | 76.8ms | 178.8ms |
| `-c '.'` | 100k.ndjson | **35.3ms** | 262.2ms | 82.4ms | 216.9ms |
| `-c 'select(.score>50)|{name,score}'` | 100k.ndjson | **28.0ms** | 178.3ms | 138.2ms | 182.6ms |
| `'.name'` | 1m.ndjson | **123.8ms** | 1.29s | 722.6ms | 1.72s |
| `-c '.'` | 1m.ndjson | **131.8ms** | 2.67s | 791.9ms | 2.15s |
| `-c 'select(.score>50)|{name,score}'` | 1m.ndjson | **140.6ms** | 1.75s | 1.34s | 1.80s |

### GH Archive NDJSON (parallel processing)

Real-world GitHub event data (~1.1GB). qj processes NDJSON in parallel across all cores.

| Filter | File | **qj** | jq | jaq | gojq |
|--------|------|------|------|------|------|
| `-c '.'` | gharchive.ndjson | **787.0ms** | 29.65s | 5.41s | 10.32s |
| `'.actor.login'` | gharchive.ndjson | **548.6ms** | 8.28s | 3.18s | 6.61s |
| `-c 'select(.type == "PushEvent") | {actor: .actor.login, commits: (.payload.commits // [] | length)}'` | gharchive.ndjson | **2.83s** | 8.40s | 3.62s | 6.84s |

### GH Archive JSON (single document)

Same data as above wrapped in a JSON array (~1.1GB single document).

| Filter | File | **qj** | jq | jaq | gojq |
|--------|------|------|------|------|------|
| `-c '.'` | gharchive.json | **400.5ms** | 29.87s | 5.85s | 9.20s |
| `'.[].actor.login'` | gharchive.json | **3.26s** | 9.37s | 3.65s | 6.62s |
| `-c '[.[] | select(.type == "PushEvent")]'` | gharchive.json | **3.65s** | 14.61s | 4.73s | 7.58s |

### Throughput

Peak parse throughput (`-c '.'` on large_twitter.json, 49MB):

| **qj** | jq | jaq | gojq |
|------|------|------|------|
| **2.6 GB/s** | 40 MB/s | 180 MB/s | 102 MB/s |

GH Archive throughput (`-c '.'` on gharchive.json, 1131MB):

| **qj** | jq | jaq | gojq |
|------|------|------|------|
| **2.8 GB/s** | 38 MB/s | 193 MB/s | 123 MB/s |

### Summary (times faster than jq)

| Category | **qj** | jaq | gojq |
|----------|------|------|------|
| JSON (large_twitter.json) | **4.0x** | 2.5x | 1.6x |
| NDJSON (1m.ndjson) | **13.8x** | 2.0x | 1.0x |
| GH Archive NDJSON (gharchive.ndjson) | **11.9x** | 3.2x | 1.6x |
| GH Archive JSON (gharchive.json) | **9.5x** | 3.4x | 2.1x |

Geometric mean of per-filter speedups (median time). Higher is better.
