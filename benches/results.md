# Benchmarks

> Auto-generated by `cargo run --release --bin bench_tools`. Do not edit manually.
> Last updated: 2026-02-16 on `Apple M4 Pro (48 GB)`

All benchmarks: warm cache (`--warmup 3`), 3 runs, output to pipe. NDJSON uses parallel processing.
Median of 3 runs via [hyperfine](https://github.com/sharkdp/hyperfine).

| Filter | File | **qj** | jq | jaq | gojq |
|--------|------|------|------|------|------|
| `-c '.'` | large_twitter.json | **17.7ms** | 1.14s | 248.4ms | 465.2ms |
| `-c '.statuses'` | large_twitter.json | **206.9ms** | 1.14s | 249.8ms | 458.4ms |
| `'.statuses|length'` | large_twitter.json | **34.4ms** | 361.3ms | 156.9ms | 298.7ms |
| `-c 'keys'` | large_twitter.json | **35.7ms** | 364.4ms | 151.5ms | 294.4ms |
| `'.statuses[]|.user.name'` | large_twitter.json | **151.6ms** | 366.6ms | 164.8ms | 315.8ms |
| `'.statuses[]|select(.retweet_count>0)|{user:.user.screen_name,n:.retweet_count}'` | large_twitter.json | **155.9ms** | 378.1ms | 165.1ms | 318.7ms |
| `'[.statuses[]|.retweet_count|floor]'` | large_twitter.json | **158.9ms** | 375.8ms | 163.9ms | 302.0ms |
| `'[.statuses[]|.user.screen_name|split("_")|join("-")]'` | large_twitter.json | **160.5ms** | 384.3ms | 190.7ms | 304.7ms |
| `'[.statuses[]|.user.screen_name]|unique|length'` | large_twitter.json | **155.9ms** | 379.3ms | 163.0ms | 304.4ms |
| `'[paths(scalars)]|length'` | large_twitter.json | **366.4ms** | 1.37s | 1.35s | 1.54s |
| `'.statuses[0]|map_values(tojson)'` | large_twitter.json | **146.4ms** | 363.6ms | 153.0ms | 304.9ms |
| `'reduce .statuses[] as $s (0; . + $s.retweet_count)'` | large_twitter.json | **152.1ms** | 368.1ms | 151.1ms | 298.7ms |
| `'.statuses[] | . as $s | {name: $s.user.screen_name, rts: $s.retweet_count}'` | large_twitter.json | **160.6ms** | 376.6ms | 171.2ms | 309.3ms |
| `'[.statuses[].user.screen_name][:5]'` | large_twitter.json | **150.1ms** | 369.2ms | 163.2ms | 308.6ms |
| `'[.statuses[] | try (1 / .retweet_count)]'` | large_twitter.json | **151.3ms** | 373.8ms | 157.0ms | 312.9ms |
| `'[.statuses[] | if .retweet_count > 10 then "viral" elif .retweet_count > 0 then "shared" else "original" end]'` | large_twitter.json | **158.3ms** | 372.2ms | 154.7ms | 299.7ms |
| `-c 'walk(if type == "boolean" then not else . end)'` | large_twitter.json | **373.7ms** | 3.47s | 2.10s | 1.61s |
| `-c '.statuses[0].retweet_count |= . + 1'` | large_twitter.json | **209.9ms** | 1.15s | 247.9ms | 464.2ms |
| `-c '.statuses[] |= (.retweet_count += 1)'` | large_twitter.json | **224.1ms** | 1.18s | 254.8ms | 490.9ms |
| `-c '[.statuses[]|.user.screen_name|gsub("_"; "-")]'` | large_twitter.json | **167.1ms** | 423.0ms | 195.1ms | 328.6ms |
| `-c '[.statuses[]|"@\(.user.screen_name): \(.text[0:30])"]'` | large_twitter.json | **163.9ms** | 390.3ms | 163.1ms | 315.9ms |
| `-c '[.statuses[]|.user.screen_name|@base64]'` | large_twitter.json | **157.2ms** | 370.5ms | 162.4ms | 301.2ms |
| `-c 'def hi(rt): if rt > 10 then "viral" elif rt > 0 then "shared" else "none" end; [.statuses[] | hi(.retweet_count)]'` | large_twitter.json | **165.1ms** | 365.2ms | 154.4ms | 304.3ms |

### NDJSON (parallel processing)

qj processes NDJSON in parallel across all cores using rayon.

| Filter | File | **qj** | jq | jaq | gojq |
|--------|------|------|------|------|------|
| `'.name'` | 1m.ndjson | **24.4ms** | 1.16s | 606.4ms | 1.72s |
| `-c 'length'` | 1m.ndjson | **24.6ms** | 1.03s | 444.0ms | 1.70s |
| `-c 'keys'` | 1m.ndjson | **57.8ms** | 2.09s | 757.2ms | 2.01s |
| `-c 'select(.score > 50)'` | 1m.ndjson | **30.2ms** | 1.90s | 942.6ms | 1.91s |
| `-c '{name,city,score}'` | 1m.ndjson | **71.5ms** | 2.17s | 1.49s | 2.15s |
| `-c 'select(.active == true) | .name'` | 1m.ndjson | **30.4ms** | 1.20s | 940.5ms | 1.46s |
| `-c 'select(.score > 50) | {name, score}'` | 1m.ndjson | **50.6ms** | 1.57s | 1.14s | 1.77s |
| `-c '.'` | 1m.ndjson | **133.8ms** | 2.42s | 696.5ms | 2.13s |
| `-c '{name, score_pct: ((.score / 100 * 100) | floor)}'` | 1m.ndjson | **159.3ms** | 2.01s | 1.25s | 2.33s |

### Throughput

Peak parse throughput (`-c '.'` on large_twitter.json, 49MB):

| **qj** | jq | jaq | gojq |
|------|------|------|------|
| **2.7 GB/s** | 43 MB/s | 197 MB/s | 105 MB/s |

### Summary (times faster than jq)

| Category | **qj** | jaq | gojq |
|----------|------|------|------|
| JSON (large_twitter.json) | **3.8x** | 2.5x | 1.4x |
| NDJSON (1m.ndjson) | **32.3x** | 1.9x | 0.9x |

Geometric mean of per-filter speedups (median time). Higher is better.
